{
    "metadata": {
        "title": "Spitz, A Risk Model for Prediction of Lung Cancer",
        "description": "The Spitz model considers a persons Ã‚\u0098hazard or rate of two events within the next year: death or lung cancer diagnosis. This model was created within a collection of lung cancer models including Etzel Model, Tammemagi Model, Park Model, Marcus Model, Hoggart Model, Cassidy Model, and Bach Model.",
        "citations": [
            {
                "title": null,
                "at": null
            }
        ]
    },
    "inputMessage": "<rdf:RDF xmlns:ot=\"http://uofm.org/objectteller/#\"\n         xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/inputMessage\">\n        <ot:noofparams>20</ot:noofparams>\n        <ot:params>\n            <rdf:Seq>\n                <rdf:li>sex</rdf:li>\n                <rdf:li>age</rdf:li>\n                <rdf:li>smokerStatus</rdf:li>\n                <rdf:li>ets</rdf:li>\n                <rdf:li>emphysema</rdf:li>\n                <rdf:li>hayFever</rdf:li>\n                <rdf:li>dust</rdf:li>\n                <rdf:li>fumes</rdf:li>\n                <rdf:li>chemicals</rdf:li>\n                <rdf:li>asbestos</rdf:li>\n                <rdf:li>pesticides</rdf:li>\n                <rdf:li>woodDust</rdf:li>\n                <rdf:li>asthma</rdf:li>\n                <rdf:li>famHxCanc</rdf:li>\n                <rdf:li>famHxSmokeCanc</rdf:li>\n                <rdf:li>asi</rdf:li>\n                <rdf:li>ageQuit</rdf:li>\n                <rdf:li>asc</rdf:li>\n                <rdf:li>yrsCess</rdf:li>\n                <rdf:li>packYrs</rdf:li>\n            </rdf:Seq>\n        </ot:params>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/sex/\">\n        <ot:datatype>STRING</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/age/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>9</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/smokerStatus/\">\n        <ot:datatype>STRING</ot:datatype>\n        <ot:min>0</ot:min>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/ets/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/emphysema/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/hayFever/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/dust/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/fumes/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/chemicals/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/asbestos/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/pesticides/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/woodDust/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/asthma/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/famHxCanc/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>2</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/famHxSmokeCanc/\">\n        <ot:datatype>INT</ot:datatype>\n        <ot:min>0</ot:min>\n        <ot:max>1</ot:max>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/asi/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/ageQuit/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/asc/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/yrsCess/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/packYrs/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n</rdf:RDF>\n",
    "outputMessage": "<rdf:RDF xmlns:ot=\"http://uofm.org/objectteller/\" xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n<rdf:Description rdf:about=\"http://uofm.org/objectteller/outputMessage\">\n    <ot:returntype>MAP</ot:returntype>\n</rdf:Description>\n</rdf:RDF>\n",
    "payload": {
        "content": "# Spitz: A Risk Model for Prediction of Lung Cancer\n# Lung Cancer Risk Prediction by smoking status\n# Author: Kristen McGarry\n# Last Updated: May 3, 2017\n\n\nfrom math import exp\ndef execute(inputs):\n    age = inputs[\"age\"]\n    sex = inputs[\"sex\"]\n    smokerStatus = inputs[\"smokerStatus\"]\n    ets = inputs[\"ets\"]\n    emphysema = inputs[\"emphysema\"]\n    hayFever = inputs[\"hayFever\"]\n    dust = inputs[\"dust\"]\n    fumes = inputs[\"fumes\"]\n    chemicals = inputs[\"chemicals\"]\n    asbestos = inputs[\"asbestos\"]\n    pesticides = inputs[\"pesticides\"]\n    woodDust = inputs[\"woodDust\"]\n    asthma = inputs[\"asthma\"]\n    famHxCanc = inputs[\"famHxCanc\"]\n    famHxSmokeCanc = inputs[\"famHxSmokeCanc\"]\n    asi = inputs[\"asi\"]\n    ageQuit = inputs[\"ageQuit\"]\n    asc = inputs[\"asc\"]\n    yrsCess = inputs[\"yrsCess\"]\n    packYrs = inputs[\"packYrs\"]\n\n    r = calcR(inputs)\n    H1 = calcH1(inputs)\n    H2 = calcH2(inputs)\n\n    P = ((H1*r)/((H1*r)+H2))*(1-exp(-((H1*r)+H2)))\n    prob = round(P*100,2)\n    interpretation = \"The probability of this individual being diagnosed with lung cancer in the next year and not dying is \" + str(prob) + \"%.\"\n    return {\"result\":prob,\"interpretation\":interpretation}\n\n\ndef calcR(inputs):\n    #Odds Ratios (OR) is approx equivalent to r\n    OR = {\n      \"never\": {\"ets\":1.77,\"hayFever\":0.90,\"dust\":1.48,\"fumes\":1.02,\"chemicals\":1.0,\"asbestos\":0.86,\"pesticides\":1.52,\"woodDust\":0.87,\"asthma\":1.43,\"famHxCanc\":[1.0,1.19,1.96],\"famHxSmokeCanc\":[1.0,1.17]},\n      \"former\": {\"ets\":2.07,\"emphysema\":2.99,\"hayFever\":0.72,\"dust\":1.64,\"fumes\":1.32,\"chemicals\":1.25,\"asbestos\":1.25,\"pesticides\":1.22,\"woodDust\":1.23,\"asthma\":1.23,\"famHxCanc\":[1.0,1.16,1.84],\"famHxSmokeCanc\":[1.0,1.40],\"asi\":1.01,\"ageQuit\":1.57,\"asc\":1.03,\"yrsCess\":0.99,\"packYrs\":1.00},\n      \"current\": {\"emphysema\":2.69,\"hayFever\":0.62,\"dust\":1.67,\"fumes\":1.31,\"chemicals\":1.34,\"asbestos\":1.78,\"pesticides\":1.0,\"woodDust\":1.20,\"asthma\":1.01,\"famHxCanc\":[1.0,1.24,1.68],\"famHxSmokeCanc\":[1.0,1.58],\"asi\":0.97,\"packYrs\":1.01}\n    }\n    r = 1\n    smokerStatus = inputs[\"smokerStatus\"]\n    for covariate in inputs.keys():\n        if (covariate != \"smokerStatus\") and (inputs[covariate] != 0) and (covariate != \"age\") and (covariate != \"sex\"):\n            if covariate not in OR[smokerStatus].keys():\n                print \"Not applicable: \" + str(covariate)\n                continue\n            if (covariate == \"famHxCanc\") or (covariate == \"famHxSmokeCanc\"):\n                OR_temp = OR[smokerStatus][covariate][inputs[covariate]]\n                r *= OR_temp\n                continue\n            if covariate in [\"asi\",\"asc\",\"yrsCess\",\"packYrs\"]:\n                OR_temp = (OR[smokerStatus][covariate]) * (inputs[covariate])\n                r *= OR_temp\n                continue\n            OR_temp = OR[smokerStatus][covariate]\n            r *= OR_temp\n        else:\n            continue\n    return r\n\ndef calcH1(inputs):\n    age = inputs[\"age\"]\n    sex = inputs[\"sex\"]\n    smokerStatus = inputs[\"smokerStatus\"]\n\n    v = {\"male\":[10.78,25.49,56.60,116.58,221.18,346.77,478.1,564.36,532.36,498.44],\n         \"female\":[11.03,23.19,45.51,93.93,164.9,246.85,318.69,344.67,308.28,266.72]}\n    s = {\"never\":0.4751,\"former\":0.45352,\"current\":0.51404}\n\n    v_temp = ((v[sex][age])/100000)\n    s_temp = s[smokerStatus]\n\n    H1 = v_temp*(1-s_temp)\n    return H1\n\ndef calcH2(inputs):\n    age = inputs[\"age\"]\n    sex = inputs[\"sex\"]\n\n    # MR = Mortality Rate\n    MR = {\"male\":[2.75,400.7,560.0,786.9,1210.2,1855.1,2947.4,4836.4,7980.7,15559.4],\n         \"female\":[153.2,218.8,313.4,479.10,762.9,1197.0,1968.30,3306.10,5761.2,14016.2]}\n    MR_temp = MR[sex][age]\n    return (MR_temp/100000)\n\n\ndef test():\n    if execute({\"sex\":\"male\",\"age\":8,\"smokerStatus\":\"former\",\"ets\":0,\"emphysema\":0,\"hayFever\":0,\"dust\":1,\"fumes\":1,\"chemicals\":1,\"asbestos\":0,\"pesticides\":1,\"woodDust\":0,\"asthma\":0,\"famHxCanc\":0,\"famHxSmokeCanc\":0,\"asi\":25,\"ageQuit\":30,\"asc\":0,\"yrsCess\":1,\"packYrs\":0}) != {'interpretation': 'The probability of this individual being diagnosed with lung cancer in the next year and not dying is 30.26%.', 'result': 30.26}:\n        return \"error.\"\n    if execute({\"sex\":\"female\",\"age\":5,\"smokerStatus\":\"current\",\"ets\":0,\"emphysema\":1,\"hayFever\":0,\"dust\":0,\"fumes\":0,\"chemicals\":0,\"asbestos\":0,\"pesticides\":0,\"woodDust\":1,\"asthma\":0,\"famHxCanc\":2,\"famHxSmokeCanc\":0,\"asi\":76,\"ageQuit\":0,\"asc\":0,\"yrsCess\":0,\"packYrs\":0}) != {'interpretation': 'The probability of this individual being diagnosed with lung cancer in the next year and not dying is 37.89%.', 'result': 37.89}:\n        return \"error.\"\n    if execute({\"sex\":\"female\",\"age\":9,\"smokerStatus\":\"never\",\"ets\":1,\"emphysema\":0,\"hayFever\":1,\"dust\":0,\"fumes\":0,\"chemicals\":0,\"asbestos\":0,\"pesticides\":0,\"woodDust\":1,\"asthma\":1,\"famHxCanc\":2,\"famHxSmokeCanc\":1,\"asi\":0,\"ageQuit\":0,\"asc\":0,\"yrsCess\":0,\"packYrs\":0}) != {'interpretation': 'The probability of this individual being diagnosed with lung cancer in the next year and not dying is 0.59%.', 'result': 0.59}:\n        return \"error.\"\n    if execute({\"sex\":\"male\",\"age\":2,\"smokerStatus\":\"never\",\"ets\":0,\"emphysema\":0,\"hayFever\":0,\"dust\":0,\"fumes\":0,\"chemicals\":0,\"asbestos\":0,\"pesticides\":0,\"woodDust\":0,\"asthma\":1,\"famHxCanc\":0,\"famHxSmokeCanc\":0,\"asi\":0,\"ageQuit\":0,\"asc\":0,\"yrsCess\":0,\"packYrs\":0}) != {'interpretation': 'The probability of this individual being diagnosed with lung cancer in the next year and not dying is 0.04%.', 'result': 0.04}:\n        return \"error.\"\n    return \"ok.\"\n",
        "engineType": "Python",
        "functionName": "execute"
    },
    "url": "https://dlhs-fedora-dev.med.umich.edu/ObjectTeller/knowledgeObject/ark:/99999/fk4k64rx3z",
    "source": "user-generated"
}
