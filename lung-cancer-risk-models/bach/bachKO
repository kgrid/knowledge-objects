{
    "metadata": {
        "title": "Bach, Variations in Lung Cancer Risk Among Smokers",
        "description": "Lung Cancer Risk Prediction Model: Estimates the absolute risk that an individual will be diagnosed with lung cancer within 10 years, given the probability of being diagnosed with lung cancer within 10 years and the probability that an individual will die without being diagnosed with lung cancer.  This model was created within a collection of lung cancer models including Spitz Model, Tammemagi Model, Park Model, Marcus Model, Etzel Model, Cassidy Model, and Hoggart Model.",
        "citations": [
            {
                "title": null,
                "at": null
            }
        ]
    },
    "inputMessage": "<rdf:RDF xmlns:ot=\"http://uofm.org/objectteller/#\"\n         xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/inputMessage\">\n        <ot:noofparams>7</ot:noofparams>\n        <ot:params>\n            <rdf:Seq>\n                <rdf:li>age</rdf:li>\n                <rdf:li>cpd</rdf:li>\n                <rdf:li>yrsSmok</rdf:li>\n                <rdf:li>yrsQuit</rdf:li>\n                <rdf:li>asbestos</rdf:li>\n                <rdf:li>sex</rdf:li>\n                <rdf:li>quit</rdf:li>\n            </rdf:Seq>\n        </ot:params>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/age/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/cpd/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/yrsSmok/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/yrsQuit/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/asbestos/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/sex/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n    <rdf:Description rdf:about=\"http://uofm.org/objectteller/quit/\">\n        <ot:datatype>INT</ot:datatype>\n    </rdf:Description>\n</rdf:RDF>\n",
    "outputMessage": "<rdf:RDF xmlns:ot=\"http://uofm.org/objectteller/\"\n  xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n  <rdf:Description rdf:about=\"http://uofm.org/objectteller/outputMessage\">\n    <ot:returntype>MAP</ot:returntype>\n  </rdf:Description>\n</rdf:RDF>\n",
    "payload": {
        "content": "# Bach, Variations in Lung Cancer Risk Among Smokers (Bach et al, 2003)\r\n# Code adopted from Bach et al.\r\n\r\nimport math\r\nimport sys\r\n\r\ndef otherRisk(cpd, yrsSmok, sex, yrsQuit, age, asbestos):\r\n\t\totherHazard = -7.2036219 + (0.015490665 * cpd) - (1.737645e-005 * math.pow(max((cpd - 15), 0),3)) + (2.1924149e-005 * math.pow(max(cpd - 20.185718, 0),3)) - (4.5476985e-006 * math.pow(max(cpd - 40, 0),3)) + (0.020041889 * yrsSmok) + (6.5443781e-006 * math.pow(max(yrsSmok - 27.6577, 0),3)) - (1.3947696e-005 * math.pow(max(yrsSmok - 40, 0),3)) + (7.4033175e-006 * math.pow(max(yrsSmok - 50.910335, 0),3)) - (0.023358962 * yrsQuit) + (0.0019208669 * math.pow(max(yrsQuit, 0),3)) - (0.0020031611 * math.pow(max(yrsQuit - 0.50513347, 0),3)) + (8.2294194e-005 * math.pow(max(yrsQuit - 12.295688, 0),3)) + (0.099168033 * age) + (6.2174577e-006 * math.pow(max(age - 53.459001, 0),3)) - (1.2115774e-005 * math.pow(max(age - 61.954825, 0),3)) + (5.8983164e-006 * math.pow(max(age - 70.910335, 0),3)) + (0.06084611 * asbestos) - (0.49042298 * sex)\r\n\t\totherRisk = 1 - (math.pow(0.9917663, math.exp(otherHazard)))\r\n\t\treturn otherRisk\r\n\r\n\r\ndef lungRisk(cpd, yrsSmok, sex, yrsQuit, age, asbestos):\r\n\t\tlungHazard = -9.7343079 + 0.056969707 * cpd - 0.00013478222 * math.pow(max(cpd - 15,0),3) + 0.00017005691 * math.pow(max(cpd - 20.185718, 0),3) - 3.5274691e-005 * math.pow(max(cpd - 40,0),3) + 0.11605295 * yrsSmok - 8.1798667e-005 * math.pow(max(yrsSmok - 27.6577, 0),3) + 0.00017433328 * math.pow(max(yrsSmok - 40, 0), 3) - 9.2534614e-005 * math.pow(max(yrsSmok - 50.910335, 0), 3) + 0.046940674 * yrsQuit - 0.0029232561 * math.pow(max(yrsQuit, 0),3) + 0.0030484949 * math.pow(max(yrsQuit - 0.50513347, 0), 3) - 0.00012523877 * math.pow(max(yrsQuit - 12.295688, 0),3) + 0.070434114 * age - 9.4950172e-005 * math.pow(max(age - 53.459001, 0),3) + 0.00018502656 * math.pow(max(age - 61.954825, 0),3) - 9.0076393e-005 * math.pow(max(age - 70.910335, 0),3) + 0.27095776 * asbestos - 0.2380322 * sex\r\n\t\tlungRisk = 1- (math.pow(0.997667729854584, math.exp(lungHazard)))\r\n\t#\tprint lungRisk * 100\r\n\t\t#print \"\\n\"\r\n\t\treturn lungRisk\r\n\r\ndef doCalculation(age, cpd, yrsSmok, yrsQuit, asbestos, sex, quit):\r\n\tpopulation = 1\r\n\ttotalOther = 0\r\n\ttotalLung = 0\r\n\tfor year in range(0,10):\r\n\t\tdeaths = otherRisk(cpd, yrsSmok, sex, yrsQuit, age, asbestos) * population\r\n\t\tpopulation = population - deaths\r\n\t\ttotalOther = totalOther + deaths\r\n\t\tlungDeaths = lungRisk(cpd, yrsSmok, sex, yrsQuit, age, asbestos) * population\r\n\t\tpopulation = population - lungDeaths\r\n\t\ttotalLung = totalLung + lungDeaths\r\n\t\tage=age+1 #increment age\r\n\t\tyrsQuit=yrsQuit + quit #increment years quit\r\n\t\tyrsSmok = yrsSmok + abs(quit - 1) #increment yrsQuit if the person has quit\r\n\treturn totalLung\r\n\r\ndef execute(inputs):\r\n\tage = inputs[\"age\"]\r\n\tcpd = inputs[\"cpd\"]\r\n\tyrsSmok = inputs[\"yrsSmok\"]\r\n\tyrsQuit = inputs[\"yrsQuit\"]\r\n\tasbestos = inputs[\"asbestos\"]\r\n\tsex = inputs[\"sex\"]\r\n\tquit = inputs[\"quit\"]\r\n\r\n\trunModel = doCalculation(age, cpd, yrsSmok, yrsQuit, asbestos, sex, quit)\r\n\trunModelOut = round(runModel*100,2)\r\n\tinterpretation  = \"This individual has a total lung cancer risk of \" + str(runModelOut) + \"% in the next 10 years.\"\r\n\treturn {\"result\":runModelOut,\"interpretation\":interpretation}\r\n\r\ndef test():\r\n\tif execute({\"age\":55, \"cpd\":20, \"yrsSmok\":30, \"yrsQuit\":0, \"asbestos\":0, \"sex\":1, \"quit\":1}) != {'interpretation': 'This individual has a total lung cancer risk of 0.78% in the next 10 years.', 'result': 0.78}:\r\n\t\treturn \"error.\"\r\n\tif execute({\"age\":62, \"cpd\":30, \"yrsSmok\":35, \"yrsQuit\":0, \"asbestos\":0, \"sex\":0, \"quit\":0}) != {'interpretation': 'This individual has a total lung cancer risk of 3.97% in the next 10 years.', 'result': 3.97}:\r\n\t\treturn \"error.\"\r\n\tif execute({\"age\":50, \"cpd\":20, \"yrsSmok\":20, \"yrsQuit\":10, \"asbestos\":1, \"sex\":0, \"quit\":1}) != {'interpretation': 'This individual has a total lung cancer risk of 0.3% in the next 10 years.', 'result': 0.3}:\r\n\t\treturn \"error.\"\r\n\tif execute({\"age\":40, \"cpd\":20, \"yrsSmok\":10, \"yrsQuit\":15, \"asbestos\":0, \"sex\":1, \"quit\":1}) != {'interpretation': 'This individual has a total lung cancer risk of 0.03% in the next 10 years.', 'result': 0.03}:\r\n\t\treturn \"error.\"\r\n\tif execute({\"age\":70, \"cpd\":40, \"yrsSmok\":55, \"yrsQuit\":0, \"asbestos\":0, \"sex\":1, \"quit\":0}) != {'interpretation': 'This individual has a total lung cancer risk of 10.47% in the next 10 years.', 'result': 10.47}:\r\n\t\treturn \"error.\"\r\n\tif execute({\"age\":20, \"cpd\":0, \"yrsSmok\":0, \"yrsQuit\":0, \"asbestos\":0, \"sex\":1, \"quit\":0}) != {'interpretation': 'This individual has a total lung cancer risk of 0.0% in the next 10 years.', 'result': 0.0}:\r\n\t\treturn \"error.\"\r\n\treturn \"ok.\"\r\n",
        "engineType": "Python",
        "functionName": "execute"
    },
    "url": "https://dlhs-fedora-dev.med.umich.edu/ObjectTeller/knowledgeObject/ark:/99999/fk4057tv7z",
    "source": "user-generated"
}
